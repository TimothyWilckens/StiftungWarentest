<!DOCTYPE html>
<html>
<head>
    <title>RSA Verfahren</title>
</head>
<body>
    <h1>RSA Verfahren</h1>
    
    <p>Bitte geben Sie die RSA-Parameter ein:</p>
    
    <label for="p">p (Primzahl): </label>
    <input type="number" id="p" required>
    
    <label for="q">q (Primzahl): </label>
    <input type="number" id="q" required>
    
    <label for="e">e (öffentlicher Exponent): </label>
    <input type="number" id="e" required>
    
    <button onclick="generateKeys()">Schlüssel generieren</button>
    
    <p id="nValue">n: </p>
    <p id="dValue">d: </p>
    
    <p>Bitte wählen Sie eine Aktion:</p>
    
    <form id="encryptForm">
        <label for="plaintext">Klartext: </label>
        <input type="text" id="plaintext" required>
        <button type="button" onclick="encryptText()">Verschlüsseln</button>
    </form>
    
    <p id="encryptedText"></p>

    <script>
        // Define RSA parameters (n, e, d, p, q)
        let n, e, d, p, q;

        // Function to generate an RSA key pair
        function generateKeys() {
            p = Number(document.getElementById("p").value);
            q = Number(document.getElementById("q").value);
            e = Number(document.getElementById("e").value);

            n = p * q;
            const phi = (p - 1) * (q - 1);
            
            d = findMultiplicativeInverse(e, phi);
            
            document.getElementById("nValue").textContent = "n: " + n;
            document.getElementById("dValue").textContent = "d: " + d;
        }

        // Function to calculate the multiplicative inverse of 'a' modulo 'm'
        function findMultiplicativeInverse(a, m) {
            for (let x = 1; x < m; x++) {
                if ((a * x) % m === 1) {
                    return x;
                }
            }
            return 1;
        }

        // Function to encrypt text using RSA
        function rsaEncrypt(plaintext, e, n) {
            // Implement RSA encryption logic with the given plaintext, public exponent (e), and modulus (n)
            // Return the encrypted result
            let encryptedResult = BigInt(plaintext).modPow(BigInt(e), BigInt(n));
            return encryptedResult.toString();
        }

        // Function to encrypt text
        function encryptText() {
            const plaintext = document.getElementById("plaintext").value;
            const encryptedResult = rsaEncrypt(plaintext, e, n);

            // Anstatt nur den Text anzuzeigen, setze ihn direkt in das HTML-Element ein
            document.getElementById("encryptedText").innerHTML = "Verschlüsselter Text: <strong>" + encryptedResult + "</strong>";

            // Du kannst auch den verschlüsselten Text für andere Zwecke verwenden (z.B., ihn an den Server senden)
        }
    </script>
</body>
</html>